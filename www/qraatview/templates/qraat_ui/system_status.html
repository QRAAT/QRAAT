{% extends "qraat_ui/base.html" %}

{% block extrascript %}
    <script src="/static/flot/jquery.min.js" type="text/javascript"></script>
    <script src="/static/flot/jquery.flot.min.js" type="text/javascript"></script>
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="excanvas.min.js"></script><![endif]-->
    <script type="text/javascript">
        $(document).ready(function(){
            var selected_obj = $("#obj-sel").val();

            var data = {{data|safe}};
            var fields = {{fields|safe}}
            var axis = ['site-list', 'axis-y']

            if(data){
                plotGraph(data);
            }

            if(fields){
                
            }

        });

        function plotGraph(dataset, fields){
            var plotData = {};
            plotData.label = "Test";
            plotData.data = new Array();

            for(var i=0; i<dataset.length; i++){
                var set = new Array();
                for(j=0; j<fields.length; j++){
                    set.push(dataset[i][fields[j]]);
                }
                plotData.data.push(set);
            }
            var options = {};
            options.series = {};
            options.series.lines = {show: true};

            $.plot($("#placeholder"), [plotData.data] , options);
        }
    </script>
{% endblock %}

{% block sidebar %} {% include "qraat_ui/status_sidebar.html" %} {% endblock %}

{% block content %}
   <div class="row">
        <h4>System status</h4>
   </div>

    <div class="container-fluid">
        <form class="form-horizontal" method="get" role="form">
            <input id="obj-sel" type="hidden" name="obj" value="telemetry"></input>

            <div class="row">
                <div class="col-md-4">
                   <h5>
                      Controls 
                   </h5>
                </div>
                <div class="col-md-4">
                    <button type="submmit" class="btn btn-primary btn-sm">Plot</button>
                </div>
            </div>


            <div id="axis" class="row">
                <div class='col-md-offset-0 col-md-4'>
                        <input type="hidden" name="field" value="siteID"></input>
                        <!-- <input type="hidden" name="static_field" value="siteID"></input> -->
                        <div class='input-group'>
                            <div class='input-group-addon'>Site</div>
                            <select id='site_list' class='form-control' name='filter_field'>
                                {% for value in static_field_values %}
                                    <option value={{value}}>{{value}} </option>
                                {% endfor %}
                            </select>
                        </div>
                </div>

                <div class='col-md-4'>
                    <div class='input-group'>
                        <div class='input-group-addon'>Axis Y</div>
                        <select id='axis_y' class='form-control' name='field'>
                            {% for key in obj_fields_keys %}
                                <option value={{key}}> {{key}}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>    
            </div>
        </form>

        <div class="row">
            <div id="placeholder" class="col-md-8" style="width:600px; height:300px; margin-top:4%;"></div>
        </div>
    </div>
{% endblock %}

